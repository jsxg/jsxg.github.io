function initMap(){createMap(),setMapEvent(),addMapControl(),addMarker()}function createMap(){var n=new BMap.Map("map"),e=new BMap.Point(114.188527,22.302487);n.centerAndZoom(e,18),window.map=n}function setMapEvent(){map.enableDragging(),map.enableScrollWheelZoom(),map.enableDoubleClickZoom(),map.enableKeyboard()}function addMapControl(){var n=new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_ZOOM});map.addControl(n);var e=new BMap.OverviewMapControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,isOpen:0});map.addControl(e);var a=new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT});map.addControl(a)}function addMarker(){for(var n=0;n<markerArr.length;n++){var e=markerArr[n],a=e.point.split("|")[0],o=e.point.split("|")[1],t=new BMap.Point(a,o),i=createIcon(e.icon),r=new BMap.Marker(t,{icon:i}),p=(createInfoWindow(n),new BMap.Label(e.title,{offset:new BMap.Size(e.icon.lb-e.icon.x+10,-20)}));r.setLabel(p),map.addOverlay(r),p.setStyle({borderColor:"#808080",color:"#333",cursor:"pointer"}),function(){var a=createInfoWindow(n),o=r;o.addEventListener("click",function(){this.openInfoWindow(a)}),a.addEventListener("open",function(){o.getLabel().hide()}),a.addEventListener("close",function(){o.getLabel().show()}),p.addEventListener("click",function(){o.openInfoWindow(a)}),e.isOpen&&(p.hide(),o.openInfoWindow(a))}()}}function createInfoWindow(n){var e=markerArr[n];return new BMap.InfoWindow("<b class='iw_poi_title' title='"+e.title+"'>"+e.title+"</b><div class='iw_poi_content'>"+e.content+"</div>")}function createIcon(n){return new BMap.Icon("http://app.baidu.com/map/images/us_mk_icon.png",new BMap.Size(n.w,n.h),{imageOffset:new BMap.Size(-n.l,-n.t),infoWindowOffset:new BMap.Size(n.lb+5,1),offset:new BMap.Size(n.x,n.h)})}var markerArr=[{title:"我的标记",content:"我的备注",point:"114.187993|22.303106",isOpen:0,icon:{w:21,h:21,l:0,t:0,x:6,lb:5}}];initMap();